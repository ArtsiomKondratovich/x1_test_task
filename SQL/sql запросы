/* 1 */

SELECT 
	client_number,
  SUM(CASE WHEN outcome = 'win' then 1 else 0 end) AS count_win,
  SUM(CASE WHEN outcome = 'lose' then 1 else 0 end) AS count_lose
FROM bid 
INNER JOIN event_value as win ON bid.play_id = win.play_id
WHERE bid.coefficient = win.value
GROUP BY client_number

/* 2 */

SELECT 
	(CASE 
    	WHEN home_team > away_team
        THEN CONCAT(away_team, '-', home_team)
        ELSE CONCAT(home_team, '-', away_team)
	END) AS game,
	COUNT(*) AS game_count 
FROM event_entity
GROUP BY game
ORDER BY game_count ASC
